#!/bin/bash
PATH=$PATH:$HOME/bin:/home/linuxbrew/.linuxbrew/bin:/home/linuxbrew/.linuxbrew/sbin/:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin
#-----------------------------------
# Source global definitions
# --> Прочитать настройки из /etc/bashrc
. ~/.bashrc
# --> Прочитать настройки из ~/bin/.varfunc.sh
. ~/bin/utility/.varfunc.sh
# --> Использовать ~/.bash_aliases
. ~/.bash_aliases ;
# --> Использовать . ~/bin/utility/.root (требует для скрипта права root)
. ~/bin/utility/.root

MY_L_IP=$(/sbin/ifconfig enp0s3 | awk '/inet / { print $2 } ' ) ;
#echo $MY_L_IP | awk ' /./ { print $1 } ' ;
echo && echo -en "${RED} *** ${NC} $(ifconfig enp0s3 | grep 'inet '| grep -v '127.0.0.1' | awk '{ print $2}') ${RED} *** ${NC}\n" ;
echo -e "${RED} -------------------------------------------------------------- ${NC}" ;
echo -en " " && hostname --all-ip-addresses ;
echo -e "${RED} -------------------------------------------------------------- ${NC}" ;
echo -e "${RED} *** ${NC}Нужно ввести ip адрес через пробел вместо точек,  ${RED} *** ${NC}" ;
echo -e "${RED} *** ${NC}без последней цифры. Вместо нее ${GREEN}опция: ${RED} *** ${NC}" ;
echo -e "${RED} *** ${NC}127 0 0 ${GREEN}10  ${RED} *** ${NC}" ;
echo -e "${RED} *** ${NC}где 127 0 0 это начало адреса 127.0.0.1 ${RED} *** ${NC}" ;
echo -e "${RED} *** ${NC}а ${GREEN}10${NC} опция (количество сканируемых хостов от 0-10) ${RED} *** ${NC}" ;
echo -e "${RED} *** ${NC}Опции: 10 20 30 до 254, 254+, 254-mac ${RED} *** ${NC}" ;
echo -e "${RED} *** ${NC}Без опции скан первых 10 хостов от 0-10 + nmap -A -Pn -T5 ${RED} *** ${NC}\n" ;

case $4 in 
	10 )
		for i in {1..10}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..10}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -Pn -F -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;
# /bin/bash /root/bin/tpn $tip
	20 )
		for i in {1..20}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..20}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -Pn -F -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;

	30 )
		for i in {1..30}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..30}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -Pn -F -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;

	40 )
		for i in {1..40}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..40}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -Pn -F -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;

	50 | 60 )
		for i in {1..50}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..50}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -Pn -F -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;

	70 | 80 | 90 )
		for i in {1..70}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..70}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -Pn -F -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;

	100 | 110 | 120 | 130 | 140 )
		for i in {1..100}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..100}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -Pn -F -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;

	150 | 160 | 170 | 180 | 190 | 200 | 210 | 220 )
		for i in {1..150}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..150}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -Pn -F -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;


	254 | 230 | 240 | 250 )
		for i in {1..254}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..254}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -Pn -F -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;

	254+ )
		for i in {1..254}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i"  || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..254}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -A -Pn -T4 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
;;

	254-mac )
			for i in {1..254}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && tip=$"$1.$2.$3.$i" && echo $"$1.$2.$3.$i" > /tmp/zzz.ip.txt && echo -en ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && echo -en " " && nmap -Pn -F -T5 $tip | rg "MAC Address" | bat --paging=never -l nix -p && echo ; done ;
			echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n"
			nmap -F -Pn -T5 -iL /tmp/zzz.ip.txt | bat --paging=never -l nix -p && echo ;
		echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n"
		#rm -rf /tmp/zzz.ip.txt
		#rm -rf /tmp/resultnmap.zzz
;;

	*)
		for i in {1..10}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e "" ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} ; done ;
			echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}\n" ;
			for i in {1..10}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e "\n" ${GREEN} +++${NC} $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC} && tip=$"$1.$2.$3.$i" && nmap -A -Pn -T5 $tip | bat --paging=never -l nix -p && echo || echo -e "${ELLOW} -${NC}-- $1.$2.$3.${ELLOW}$i${NC} ни кого нет "| sort -n ; done ;
			echo -e "\nПросканировано до $1.$2.$3.${ELLOW}$i${NC}"
# -Pn -F
;;
esac

exit 0

#for i in {1..20}; do ping -c 1 -i 2 -w 1 $1.$2.$3.$i >/dev/null && echo -e $1.$2.$3.${RED}$i${NC} is ${GREEN}up${NC}; done ;